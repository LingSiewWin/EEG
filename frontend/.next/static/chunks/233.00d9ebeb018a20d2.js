"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[233],{1233:function(e,t,o){o.r(t);var r=o(5893),n=o(7294),l=o(6495),i=o(3148);i.kL.register(i.uw,i.f$,i.od,i.jn,i.Dx,i.u,i.De),t.default=()=>{let[e,t]=(0,n.useState)([]),[o,i]=(0,n.useState)("Disconnected"),[a,s]=(0,n.useState)(!1),[d,c]=(0,n.useState)(-1),[p,x]=(0,n.useState)(0),[g,h]=(0,n.useState)(!1),[u,m]=(0,n.useState)([]),[b,f]=(0,n.useState)(!1),[y,v]=(0,n.useState)({labels:[],datasets:[]}),j=(0,n.useRef)(null),S=(0,n.useRef)({}),C=(0,n.useRef)(!1),k=(0,n.useRef)(-1),A=["/photo/1.png","/photo/2.jpeg","/photo/3.jpeg","/photo/4.jpeg","/photo/5.png"],w=["rgb(255, 99, 132)","rgb(54, 162, 235)","rgb(255, 206, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(255, 159, 64)","rgb(199, 199, 199)","rgb(83, 102, 255)"];(0,n.useEffect)(()=>{let e=[];for(let t=0;t<8;t++)e.push({label:"Channel ".concat(t+1),data:[],borderColor:w[t],backgroundColor:w[t]+"33",borderWidth:1,tension:.1,pointRadius:0});return v({labels:Array(250).fill("").map((e,t)=>t),datasets:e}),(()=>{console.log("Connecting to WebSocket for image analysis...");let e=new WebSocket("ws://localhost:8765");e.onopen=()=>{console.log("WebSocket connected for image love analysis"),i("Connected")},e.onmessage=e=>{try{let o=JSON.parse(e.data);if("status"===o.type)console.log("Status:",o.message);else if("eeg"===o.type){let e={id:"".concat(o.packet_num,"_").concat(Date.now(),"_").concat(Math.random()),timestamp:o.timestamp,channels:o.channels,packet_num:o.packet_num};if(b||(t(t=>[...t,e].slice(-10)),v(e=>{let t=e.datasets.map((e,t)=>{let r=[...e.data,o.channels[t]||0];return r.length>250&&r.shift(),{...e,data:r}});return{...e,datasets:t}})),C.current&&k.current>=0){let t=k.current;S.current[t]||(S.current[t]=[]),S.current[t].push(e)}}}catch(e){console.error("Error parsing WebSocket data:",e)}},e.onerror=e=>{console.error("WebSocket error:",e),i("Error")},e.onclose=()=>{console.log("WebSocket disconnected"),i("Disconnected")},j.current=e})(),()=>{j.current&&j.current.readyState===WebSocket.OPEN&&j.current.close()}},[b]);let D=e=>{if(e>=A.length){R();return}console.log("Showing image ".concat(e+1," of ").concat(A.length)),c(e),k.current=e,C.current=!0,x(5);let t=5,o=setInterval(()=>{if(x(--t),0===t){clearInterval(o),C.current=!1;let t=S.current[e]||[];console.log("Image ".concat(e+1,": Captured ").concat(t.length," packets")),setTimeout(()=>{D(e+1)},500)}},1e3)},R=()=>{console.log("Analyzing all images...");let e=[];for(let t=0;t<A.length;t++){let o=S.current[t]||[];if(0===o.length){e.push({imageIndex:t,imagePath:A[t],loveScore:"0",category:"No data",packets:0});continue}let r=I(o,t);e.push(r)}let t=e.reduce((e,t)=>parseFloat(t.loveScore)>parseFloat(e.loveScore)?t:e,e[0]);m(e),c(-1),s(!1),f(!0),console.log("Analysis complete!",e),console.log("Winner:",t)},I=(e,t)=>{let o=[];for(let t=0;t<8;t++){let r=e.map(e=>e.channels[t]||0);r.reduce((e,t)=>e+t,0),r.length;let n=r.map(e=>Math.abs(e)),l=n.reduce((e,t)=>e+t,0)/n.length;o.push({channel:t+1,avgAmplitude:l})}let r=o[0].avgAmplitude,n=o[1].avgAmplitude,l=(n-r)/(n+r),i=o.reduce((e,t)=>e+t.avgAmplitude,0)/8,a=50;l>0&&(a+=30*l),i>20&&(a+=10),i>40&&(a+=15),i>60&&(a+=15);let s="";return s=(a=Math.min(100,Math.max(0,a)))>=80?"Love at First Sight! \uD83D\uDC98":a>=60?"Strong Attraction \uD83D\uDC95":a>=40?"Interested \uD83D\uDC97":a>=20?"Neutral \uD83D\uDE10":"Not Interested \uD83D\uDC94",{imageIndex:t,imagePath:A[t],loveScore:a.toFixed(1),category:s,avgAmplitude:i.toFixed(2),frontalAsymmetry:(50+50*l).toFixed(1),packets:e.length}};return(0,r.jsxs)("div",{style:{fontFamily:"Arial, sans-serif",padding:"20px",backgroundColor:"#f5f5f5",minHeight:"100vh"},children:[(0,r.jsx)("h1",{style:{color:"#333",marginBottom:"20px"},children:"\uD83D\uDC98 Image-Based Love Detection System"}),(0,r.jsx)("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"white",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{style:{fontWeight:"bold"},children:"Status: "}),(0,r.jsx)("span",{style:{color:(()=>{switch(o){case"Connected":return"#4CAF50";case"Disconnected":return"#f44336";case"Error":return"#ff9800";default:return"#9e9e9e"}})(),fontWeight:"bold"},children:o})]}),(0,r.jsx)("button",{onClick:()=>{console.log("Starting image-based love analysis..."),S.current={},m([]),f(!1),s(!0),h(!0),x(5);let e=5,t=setInterval(()=>{x(--e),0===e&&(clearInterval(t),h(!1),D(0))},1e3)},disabled:"Connected"!==o||a,style:{background:a?"#ff9800":"#4CAF50",color:"white",border:"none",padding:"10px 20px",borderRadius:"5px",cursor:"Connected"!==o||a?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold",minWidth:"250px"},children:a?"ANALYZING...":"START IMAGE LOVE ANALYSIS"})]})}),g&&(0,r.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",zIndex:1e3},children:[(0,r.jsx)("div",{style:{color:"white",fontSize:"48px",marginBottom:"20px"},children:"Get Ready!"}),(0,r.jsx)("div",{style:{color:"white",fontSize:"120px",fontWeight:"bold"},children:p})]}),d>=0&&!g&&(0,r.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.9)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",zIndex:999},children:[(0,r.jsx)("div",{style:{position:"absolute",top:"20px",right:"20px",color:"white",fontSize:"36px",fontWeight:"bold",backgroundColor:"rgba(255,0,0,0.5)",padding:"10px 20px",borderRadius:"10px"},children:p}),(0,r.jsxs)("div",{style:{position:"absolute",top:"20px",left:"20px",color:"white",fontSize:"24px",backgroundColor:"rgba(0,0,0,0.5)",padding:"10px",borderRadius:"5px"},children:["Image ",d+1," of ",A.length]}),(0,r.jsx)("img",{src:A[d],alt:"Test image ".concat(d+1),style:{maxWidth:"80%",maxHeight:"80%",objectFit:"contain",borderRadius:"10px",boxShadow:"0 4px 20px rgba(0,0,0,0.5)"}}),(0,r.jsx)("div",{style:{position:"absolute",bottom:"20px",color:"white",fontSize:"18px",backgroundColor:"rgba(0,0,0,0.5)",padding:"10px 20px",borderRadius:"5px"},children:"Recording EEG response..."})]}),b&&u.length>0&&(0,r.jsx)("div",{style:{marginBottom:"20px"},children:(0,r.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",marginBottom:"20px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,r.jsx)("h2",{style:{color:"#333",marginBottom:"20px"},children:"\uD83C\uDFC6 Analysis Results - Which Image Won Your Heart?"}),(()=>{let e=u.reduce((e,t)=>parseFloat(t.loveScore)>parseFloat(e.loveScore)?t:e,u[0]);return(0,r.jsxs)("div",{style:{backgroundColor:"#4CAF50",color:"white",padding:"20px",borderRadius:"10px",marginBottom:"30px",textAlign:"center"},children:[(0,r.jsxs)("h3",{style:{margin:"0 0 10px 0"},children:["\uD83C\uDF89 WINNER: Image ",e.imageIndex+1]}),(0,r.jsxs)("div",{style:{fontSize:"48px",fontWeight:"bold"},children:[e.loveScore,"%"]}),(0,r.jsx)("div",{style:{fontSize:"24px"},children:e.category}),(0,r.jsx)("img",{src:e.imagePath,alt:"Winner",style:{width:"200px",height:"200px",objectFit:"cover",borderRadius:"10px",marginTop:"20px",border:"3px solid white"}})]})})(),(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"20px"},children:u.map((e,t)=>(0,r.jsxs)("div",{style:{padding:"15px",backgroundColor:"#f8f8f8",borderRadius:"10px",textAlign:"center",border:parseFloat(e.loveScore)===Math.max(...u.map(e=>parseFloat(e.loveScore)))?"3px solid #4CAF50":"1px solid #ddd"},children:[(0,r.jsx)("img",{src:e.imagePath,alt:"Image ".concat(t+1),style:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"8px",marginBottom:"10px"}}),(0,r.jsxs)("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:["Image ",t+1]}),(0,r.jsxs)("div",{style:{fontSize:"24px",color:"#4CAF50",fontWeight:"bold"},children:[e.loveScore,"%"]}),(0,r.jsx)("div",{style:{fontSize:"12px",marginTop:"5px"},children:e.category}),(0,r.jsxs)("div",{style:{fontSize:"11px",color:"#666",marginTop:"5px"},children:["Avg: ",e.avgAmplitude,"μV | FA: ",e.frontalAsymmetry,"%"]})]},t))}),(0,r.jsx)("div",{style:{textAlign:"center",marginTop:"30px"},children:(0,r.jsx)("button",{onClick:()=>{f(!1),m([]),c(-1)},style:{background:"#2196F3",color:"white",border:"none",padding:"12px 30px",borderRadius:"5px",cursor:"pointer",fontSize:"16px",fontWeight:"bold"},children:"RETURN TO LIVE VIEW"})})]})}),!b&&(0,r.jsx)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",marginBottom:"20px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",height:"400px"},children:(0,r.jsx)(l.x1,{data:y,options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:0},scales:{x:{display:!0,title:{display:!0,text:"Time (samples)"}},y:{display:!0,title:{display:!0,text:"Amplitude (μV)"},min:-100,max:100}},plugins:{legend:{display:!0,position:"top"},title:{display:!0,text:"Real-Time EEG Signals"}}}})}),!b&&(0,r.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"15px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,r.jsx)("h3",{style:{color:"#333",marginBottom:"15px"},children:"Live EEG Values (μV)"}),0===e.length?(0,r.jsx)("div",{style:{textAlign:"center",padding:"40px",color:"#999"},children:"Waiting for real hardware data..."}):(0,r.jsx)("div",{style:{overflowX:"auto"},children:(0,r.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{style:{borderBottom:"2px solid #ddd"},children:[(0,r.jsx)("th",{style:{padding:"10px",textAlign:"left"},children:"Packet"}),[...Array(8)].map((e,t)=>(0,r.jsxs)("th",{style:{padding:"10px",textAlign:"right",color:w[t]},children:["Ch",t+1]},t))]})}),(0,r.jsx)("tbody",{children:e.map((e,t)=>(0,r.jsxs)("tr",{style:{borderBottom:"1px solid #eee"},children:[(0,r.jsx)("td",{style:{padding:"8px"},children:e.packet_num}),e.channels.slice(0,8).map((e,t)=>(0,r.jsx)("td",{style:{padding:"8px",textAlign:"right",color:Math.abs(e)>50?"#ff9800":"#333"},children:e.toFixed(2)},t))]},e.id||t))})]})})]})]})}}}]);